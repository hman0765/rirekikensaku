<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>履歴検索</title>
  <style>
    body { font-family: sans-serif; margin: 20px; }
    #results { margin-top: 20px; }
    .result { padding: 5px; border-bottom: 1px solid #ccc; }
    .file { color: #888; font-size: 0.9em; }
  </style>
</head>
<body>
  <h1>過去の暇アニ検索</h1>
  <input type="text" id="query" placeholder="検索語を入力">
  <button onclick="search()">検索</button>
  <div id="results"></div>

  <script>
    // 読み込むJSONファイル（複数あれば増やせる）
    const jsonFiles = [
"data/201102.json"
    ];
    let allData = [];

    // ページ読み込み時にJSONを全部読む
    async function loadData() {
      for (let file of jsonFiles) {
        try {
          const res = await fetch(file);
          const data = await res.json();
          allData = allData.concat(data);
        } catch (e) {
          console.error("読み込み失敗:", file, e);
        }
      }
    }

    async function search() {
      const query = document.getElementById("query").value.trim();
      const resultsDiv = document.getElementById("results");
      resultsDiv.innerHTML = "";

      if (!query) return;

      const matches = allData.filter(item => item.content.includes(query));

      if (matches.length === 0) {
        resultsDiv.textContent = "該当なし";
        return;
      }

      for (let m of matches) {
        const div = document.createElement("div");
        div.className = "result";
        div.innerHTML = `<div>${m.content}</div>
                         <div class="file">(${m.title} : ${m.line}行目)</div>`;
        resultsDiv.appendChild(div);
      }
    }

    loadData();
  </script>
</body>
</html>









